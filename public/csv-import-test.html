<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV è³‡æ–™åŒ¯å…¥æ¸¬è©¦</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        textarea {
            min-height: 200px;
            font-family: 'Courier New', monospace;
            resize: vertical;
        }
        button {
            background-color: #00ED64;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #00d45a;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
        }
        .success {
            background-color: #e8f5e8;
            border: 1px solid #4caf50;
            color: #2e7d32;
        }
        .error {
            background-color: #ffebee;
            border: 1px solid #f44336;
            color: #c62828;
        }
        .sample-csv {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—‚ï¸ CSV è³‡æ–™åŒ¯å…¥æ¸¬è©¦å·¥å…·</h1>
        
        <div class="form-group">
            <label for="importType">åŒ¯å…¥é¡å‹ï¼š</label>
            <select id="importType">
                <option value="bible_characters">è–ç¶“äººç‰©è³‡æ–™</option>
                <option value="users">ç”¨æˆ¶è³‡æ–™</option>
            </select>
        </div>

        <div class="form-group">
            <label for="csvContent">CSV å…§å®¹ï¼š</label>
            <textarea id="csvContent" placeholder="è²¼ä¸Šæ‚¨çš„CSVè³‡æ–™...">CharacterName,ChineseName,CharacterID,StoryBook,CoreTraitsEN,CoreTraitsCN,CoreValuesEN,CoreValuesCN,BehaviorPatternEN,BehaviorPatternCN,LifeSummaryEN,LifeSummaryCN,KeyEventsEN,KeyEventsCN,RelationshipsEN,RelationshipsCN,MainChallengesEN,MainChallengesCN,ResponseToChallengesEN,ResponseToChallengesCN,LifeLessonsEN,LifeLessonsCN,ApplicationTagsEN,ApplicationTagsCN
Abraham,äºä¼¯æ‹‰ç½•,ABR001,Genesis,Faithful;Obedient;Courageous,ä¿¡å¿ƒå …å®š;é †æœ;å‹‡æ•¢,Faith and obedience in God;Trust in God's promises,å°ç¥çš„ä¿¡å¿ƒèˆ‡é †æœ;ç›¸ä¿¡ç¥çš„æ‡‰è¨±,Immediately obey God's commands;Build altars to worship,ç«‹å³éµå¾ç¥çš„å‘½ä»¤;ç¯‰å£‡æ•¬æ‹œç¥,"Abraham was called by God to leave his homeland and go to the place God would show him. He experienced covenant with God, the birth of Isaac, and offering Isaac, becoming the father of faith.",äºä¼¯æ‹‰ç½•è¢«ç¥å‘¼å¬é›¢é–‹æœ¬åœ°æœ¬æ—ï¼Œå‰å¾€ç¥æ‰€æŒ‡ç¤ºçš„åœ°æ–¹ã€‚ä»–ç¶“æ­·äº†èˆ‡ç¥ç«‹ç´„ã€ç”Ÿå­ä»¥æ’’ã€ç»ä¸Šä»¥æ’’ç­‰é‡å¤§äº‹ä»¶ï¼Œè¢«ç¨±ç‚ºä¿¡å¿ƒä¹‹çˆ¶ã€‚,"Called to leave Haran;Covenant with God;Sojourn in Egypt;Parting with Lot;Rescue of Lot;Birth of Isaac;Offering of Isaac","é›¢é–‹å“ˆè˜­å‰å¾€è¿¦å—åœ°;èˆ‡ç¥ç«‹ç´„å¾—æ‡‰è¨±;åŸƒåŠå¯„å±…;èˆ‡ç¾…å¾—åˆ†é›¢;ç‡Ÿæ•‘ç¾…å¾—;èˆ‡ç¥ç«‹ç´„ç”Ÿä»¥æ’’;ç»ä¸Šä»¥æ’’","Sarah (wife);Lot (nephew);Isaac (son);Ishmael (son)",å¦»å­æ’’æ‹‰;ä¾„å…’ç¾…å¾—;å…’å­ä»¥æ’’;ä»¥å¯¦ç‘ªåˆ©,"Fear of leaving familiar places;Frustration of childlessness;Test of offering only son",é›¢é–‹ç†Ÿæ‚‰ç’°å¢ƒçš„ææ‡¼;å¤šå¹´ç„¡å­çš„æŒ«æŠ˜;ç»ç¨ç”Ÿå­çš„è€ƒé©—,"Step out in faith on unknown journey;Continue believing in God's promises;Fully obey God's commands",æ†‘ä¿¡å¿ƒè¸ä¸ŠæœªçŸ¥æ—…ç¨‹;æŒçºŒç›¸ä¿¡ç¥çš„æ‡‰è¨±;å®Œå…¨é †æœç¥çš„å‘½ä»¤,"Faith requires action;God's promises fulfilled in His timing;Complete obedience brings blessing",ä¿¡å¿ƒéœ€è¦è¡Œå‹•è­‰æ˜;ç¥çš„æ‡‰è¨±é›–é²ä½†å¿…æˆå°±;å®Œå…¨é †æœå¸¶ä¾†ç¥çš„ç¥ç¦,"Faith model;Covenant witness;Obedience example","ä¿¡å¿ƒå…¸ç¯„;ç«‹ç´„è¦‹è­‰;é †æœæ¦œæ¨£"</textarea>
        </div>

        <button id="importBtn" onclick="importCSV()">ğŸ“¤ åŒ¯å…¥è³‡æ–™</button>

        <div id="result" class="result" style="display: none;"></div>
    </div>

    <script>
        async function importCSV() {
            const importType = document.getElementById('importType').value;
            const csvContent = document.getElementById('csvContent').value;
            const importBtn = document.getElementById('importBtn');
            const result = document.getElementById('result');

            if (!csvContent.trim()) {
                showResult('è«‹è¼¸å…¥CSVå…§å®¹', 'error');
                return;
            }

            importBtn.disabled = true;
            importBtn.textContent = 'ğŸ”„ åŒ¯å…¥ä¸­...';

            try {
                const response = await fetch('/api/admin/import-csv', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        csvContent: csvContent,
                        type: importType
                    })
                });

                const data = await response.json();

                if (data.ok) {
                    showResult(`âœ… ${data.message}`, 'success');
                    console.log('åŒ¯å…¥è©³æƒ…:', data.details);
                } else {
                    showResult(`âŒ éŒ¯èª¤: ${data.error}`, 'error');
                }
            } catch (error) {
                showResult(`âŒ ç¶²è·¯éŒ¯èª¤: ${error.message}`, 'error');
            } finally {
                importBtn.disabled = false;
                importBtn.textContent = 'ğŸ“¤ åŒ¯å…¥è³‡æ–™';
            }
        }

        function showResult(message, type) {
            const result = document.getElementById('result');
            result.textContent = message;
            result.className = `result ${type}`;
            result.style.display = 'block';
        }
    </script>
</body>
</html>